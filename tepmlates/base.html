{% load static %}
{% load i18n %}
<html lang="tr" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Homepage{% endblock title %}</title>
    <link rel="shortcut icon"  type="image/x-icon" href="{% static 'konnektom-logo.png' %}">

    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <link rel="stylesheet" href="{% static 'custom.css' %}">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {"50":"#eff6ff","100":"#dbeafe","200":"#bfdbfe","300":"#93c5fd","400":"#60a5fa","500":"#3b82f6","600":"#2563eb","700":"#1d4ed8","800":"#1e40af","900":"#1e3a8a"}
                    }
                }
            }
        }
    </script>

   <style>
 
</style>
</head>
<body class="h-full bg-gray-50 dark:bg-gray-900 ">
        <style>
            body { font-family: 'Inter', sans-serif; }
        </style>
        <div x-data="{ 
        sidebarOpen: window.innerWidth >= 640, 
        profileDropdownOpen: false,
        init() {
            // Responsive kontrolÃ¼
            window.addEventListener('resize', () => {
                this.sidebarOpen = window.innerWidth >= 640;
            });
        }
    }" class="flex h-full">
        <!-- Mobile sidebar button -->
        <button 
            x-show="!sidebarOpen"
            @click="sidebarOpen = true"
            class="inline-flex items-center p-2 mt-2 ms-3 text-sm text-gray-500 rounded-lg sm:hidden hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600 fixed z-30"
        >
            <span class="sr-only">{% trans "Open sidebar" %}</span>
            <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path clip-rule="evenodd" fill-rule="evenodd" d="M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 10z"></path>
            </svg>
        </button>

        <!-- Sidebar -->
        {% include 'components/sidebar.html' %}

        <!-- Main Content -->
        <div class="flex-1 flex flex-col" :class="{ 'sm:ml-64': sidebarOpen }">
            <!-- Navbar -->
            <header class="bg-white border-b border-gray-200 dark:bg-gray-800 dark:border-gray-700 sticky top-0 z-10">
                <div class="flex items-center justify-between px-6 py-3">
                    <!-- Sidebar Toggle (Desktop) -->
                    <button @click="sidebarOpen = !sidebarOpen" class="hidden sm:block text-gray-500 dark:text-gray-400 hover:text-gray-600 dark:hover:text-white">
                        <i class="fas fa-bars"></i>
                    </button>

                    <!-- Profile Dropdown and Language Switcher -->
                    <div class="flex flex-row items-center gap-2 h-full whitespace-nowrap">
                        <div x-data="{ open: false }" class="relative">
                            <form action="{% url 'set_language' %}" method="post" class="m-0 p-0">
                                {% csrf_token %}
                                <input name="next" type="hidden" value="{{ request.path }}" />
                                <button type="button" @click="open = !open" class="rounded border-gray-300 text-sm px-2 py-1 align-middle h-8 flex items-center gap-2 focus:ring focus:ring-primary-500 focus:outline-none"
                                    :class="{'bg-primary-600 text-white': open, 'bg-white text-gray-700': !open}">
                                    <i class="fas fa-globe"></i>
                                    <span>
                                        {% get_current_language as LANGUAGE_CODE %}
                                        {% if LANGUAGE_CODE == 'tr' %}{% trans "Turkish" %}{% elif LANGUAGE_CODE == 'en' %}{% trans "English" %}{% else %}{{ LANGUAGE_CODE }}{% endif %}
                                    </span>
                                    <i class="fas fa-chevron-down text-xs"></i>
                                </button>
                                <div x-show="open" @click.away="open = false" class="absolute left-0 mt-2 w-32 bg-white rounded-md shadow-lg py-1 z-20 dark:bg-gray-700 border border-gray-200 dark:border-gray-600">
                                    <button type="submit" name="language" value="en" class="block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600"
                                        :class="{'font-bold text-primary-600': '{{ LANGUAGE_CODE }}' === 'en'}">
                                        {% trans "English" %}
                                    </button>
                                    <button type="submit" name="language" value="tr" class="block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600"
                                        :class="{'font-bold text-primary-600': '{{ LANGUAGE_CODE }}' === 'tr'}">
                                        {% trans "Turkish" %}
                                    </button>
                                </div>
                            </form>
                        </div>
                
                        <div class="relative">
                            <button 
                                @click="profileDropdownOpen = !profileDropdownOpen"
                                class="flex items-center space-x-2 focus:outline-none"
                            >
                                <div class="w-8 h-8 rounded-full bg-primary-600 flex items-center justify-center text-white">
                                    <i class="fas fa-user"></i>
                                </div>
                                <span class="text-gray-700 dark:text-gray-300">{% trans 'Profile' %}</span>
                                <i class="fas fa-chevron-down text-xs transition-transform" :class="{ 'rotate-180': profileDropdownOpen }"></i>
                            </button>
                            <div 
                                x-show="profileDropdownOpen"
                                @click.away="profileDropdownOpen = false"
                                class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-20 dark:bg-gray-700"
                                style="display: none;"
                            >
                                <a href="{% url 'profile' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-200 dark:text-gray-300 dark:hover:bg-gray-600 transition-all">
                                    <i class="fas fa-user mr-2"></i> {% trans 'View Profile' %}
                                </a>
                                <form method="post" action="{% url 'logout' %}" style="margin:0;">
                                    {% csrf_token %}
                                    <button type="submit" class="w-full text-left block px-4 py-2 text-sm text-gray-700 hover:bg-gray-200 dark:text-gray-300 dark:hover:bg-gray-600 transition-all">
                                        <i class="fas fa-sign-out-alt mr-2"></i> {% trans 'Sign Out' %}
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            <!-- Page Content -->
            <main class="flex-1 p-6 overflow-y-auto">
                {% block content %}{% endblock content %}
            </main>
        </div>
    </div>
</body>
</html>